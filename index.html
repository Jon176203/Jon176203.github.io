<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tụi mình</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <main class="love-card">
      <div class="title">Hành trình của tụi mình Q-Q</div>
      <section class="couple">
        <div class="person">
          <div class="avatar">
            <img id="avatarA" src="https://i.pravatar.cc/400?img=32" alt="Người yêu A" />
          </div>
          <div class="name-tag" id="nameA">Tên người A</div>
        </div>
        <div class="heart">❤</div>
        <div class="person">
          <div class="avatar">
            <img id="avatarB" src="https://i.pravatar.cc/400?img=47" alt="Người yêu B" />
          </div>
          <div class="name-tag" id="nameB">Tên người B</div>
        </div>
      </section>
      <section class="time-tracker">
        <div class="time-cards">
          <div class="time-card">
            <span class="time-value" id="yearsValue">0</span>
            <span class="time-label">Năm</span>
          </div>
          <div class="time-card">
            <span class="time-value" id="monthsValue">0</span>
            <span class="time-label">Tháng</span>
          </div>
          <div class="time-card">
            <span class="time-value" id="weeksValue">0</span>
            <span class="time-label">Tuần</span>
          </div>
          <div class="time-card">
            <span class="time-value" id="daysValue">0</span>
            <span class="time-label">Ngày</span>
          </div>
        </div>
        <div class="time-meta">
          <span class="since-pill" id="sinceDate">25/10/2025</span>
          <span class="clock" id="liveClock">00 : 00 : 00</span>
        </div>
        <div class="days-counter" id="dayCount">0 ngày bên nhau</div>
      </section>
      <footer>
        <span>Cập nhật tự động mỗi ngày — thiết kế bởi hai ta</span>
      </footer>
    </main>

    <script>
      const config = {
        personA: {
          name: "Nguyễn Minh Quân",
          avatar: "assets/nguyenminhquan.jpg",
        },
        personB: {
          name: "Châu Nguyễn Diễm Quỳnh",
          avatar: "assets/diemquynh.jpg",
        },
        startDate: "2025-10-25",
      };

      let startDate;
      const MILLIS_PER_DAY = 1000 * 60 * 60 * 24;

      function formatDate(dateString) {
        const [year, month, day] = dateString.split("-");
        return `${day}/${month}/${year}`;
      }

      function padTwo(value) {
        return value.toString().padStart(2, "0");
      }

      function applyConfig() {
        document.getElementById("nameA").textContent = config.personA.name;
        document.getElementById("nameB").textContent = config.personB.name;
        document.getElementById("avatarA").src = config.personA.avatar;
        document.getElementById("avatarB").src = config.personB.avatar;
        document.getElementById("sinceDate").textContent = formatDate(config.startDate);

        startDate = new Date(`${config.startDate}T00:00:00`);
        startDate.setHours(0, 0, 0, 0);
      }

      function calculateDurations(now = new Date()) {
        if (!startDate) {
          return { years: 0, months: 0, weeks: 0, days: 0, totalDaysSinceStart: 0 };
        }

        const reference = new Date(now.getTime());
        reference.setHours(0, 0, 0, 0);

        let cursor = new Date(startDate.getTime());
        let years = 0;

        while (true) {
          const next = new Date(cursor);
          next.setFullYear(next.getFullYear() + 1);
          if (next <= reference) {
            years += 1;
            cursor = next;
          } else {
            break;
          }
        }

        let months = 0;
        while (true) {
          const next = new Date(cursor);
          next.setMonth(next.getMonth() + 1);
          if (next <= reference) {
            months += 1;
            cursor = next;
          } else {
            break;
          }
        }

        const remainingMs = reference - cursor;
        const totalDaysRemainder = Math.floor(remainingMs / MILLIS_PER_DAY);
        const weeks = Math.floor(totalDaysRemainder / 7);
        const days = totalDaysRemainder % 7;

        const totalDaysSinceStart =
          Math.floor(
            (Date.UTC(
              reference.getFullYear(),
              reference.getMonth(),
              reference.getDate()
            ) -
              Date.UTC(
                startDate.getFullYear(),
                startDate.getMonth(),
                startDate.getDate()
              )) /
              MILLIS_PER_DAY
          ) + 1;

        return { years, months, weeks, days, totalDaysSinceStart };
      }

      function updateDurations() {
        const { years, months, weeks, days, totalDaysSinceStart } = calculateDurations();

        document.getElementById("yearsValue").textContent = padTwo(years);
        document.getElementById("monthsValue").textContent = padTwo(months);
        document.getElementById("weeksValue").textContent = padTwo(weeks);
        document.getElementById("daysValue").textContent = padTwo(days);
        document.getElementById("dayCount").textContent = `${totalDaysSinceStart} ngày bên nhau`;
      }

      function updateClock() {
        const now = new Date();
        const hours = padTwo(now.getHours());
        const minutes = padTwo(now.getMinutes());
        const seconds = padTwo(now.getSeconds());
        document.getElementById("liveClock").textContent = `${hours} : ${minutes} : ${seconds}`;
      }

      applyConfig();
      updateDurations();
      updateClock();

      setInterval(() => {
        updateDurations();
        updateClock();
      }, 1000);
    </script>
  </body>
</html>

